#!/bin/bash
YLW='\033[1;33m'
NC='\033[0m' # No Color

POSITIONAL=()
while [[ $# -gt 0 ]]
do
key="$1"

case $key in
	-d|--domain)
	DOMAIN="$2"
	shift
	shift
	;;
	-s|--scope)
	SCOPE="$2"
	shift
	shift
	;;
	POSITIONAL+=("$1")
	shift
	;;
esac
done
set -- "${POSITIONAL[@]}"
echo DOMAIN="${DOMAIN}"
echo SCOPE="${SCOPE}"


echo -e "Sublist3r enumeration: ${YLW} $1 ${NC}";

#Call to sublist3r
sublist3r -d $1 2>&1 | sed -r 's/'$(echo -e "\033")'\[[0-9]{1,2}(;([0-9]{1,2})?)?[mK]//g' > sublister.txt

cat sublister.txt | awk 'BEGIN{ found=0} /Total Unique Subdomains Found/{found=1}  {if (found) print }' | awk '{if (NR!=1) {print}}'> sublister.txt


echo -e "\nList subdomains in the defined scope: ${YLW}$2${NC}";
while read line; 
do
	if nslookup $line | grep $2 > /dev/null;
	 then echo -e " ${YLW}[-]${NC} $line";
	fi
done  < sublister.txt
rm sublister.txt
